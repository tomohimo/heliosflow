# 工事システムフロー可視化アプリ（静的Web / GitHub Pages）README

## 目的（Why）
複雑な工事のシステムフローをWeb UIに落とし込み、関係者の「次なにをすればいいか？」を自己解決させる。  
現状、社員1名に質問が集中し、都度の説明・確認でコミュニケーションコストが発生している。これをUIで解消し、やり取りを最小化して業務を前に進める。

---

## 成果物（What）
GitHub Pagesで動作する**完全静的**アプリケーション。

- フロー図（ノード＋線）を閲覧できる
- ノード**マウスオーバー**で説明モーダル表示
- ノード**マウスオーバー**で「次ノードへ向かう線」をハイライト
- モーダル内リンクからファイル共有ページ（外部URL）へ遷移できる
- 検索/フィルタ（Client-side filter/map/sort）でノードを絞り込み可能
- お気に入り（Local Storage）対応
- タブ切り替え（例：フロー / 一覧 / About）

---

## 非交渉の技術制約（Non-Negotiable）
### ホスティング / 実行環境
- **GitHub Pagesのみ**
- **サーバーサイド処理禁止**
- **外部ホスティング依存禁止**

### データ
- データの唯一の正：`public/data.json`
- `data.json` は**読み取り専用**（アプリから書き戻し不可）
- 永続化は**Local Storageのみ（任意）**



### ルーティング
- GitHub Pagesの404回避のため **HashRouter** を使用

---

## UI要件（Must）
### 1) フロー図
- ノードとエッジ（線）で工事フローを表現
- ノード数が多い前提（ズーム/パン/スクロールで破綻しない）

### 2) マウスオーバー挙動
- ノードにhoverしたら：
  - **説明モーダル**を表示（フロー図を見ながら理解できるサイズ）
  - **次ノードへ行く線（エッジ）をハイライト**（分岐があれば複数ハイライト）

### 3) モーダル内容
最低限：
- ノード名（タスク名）
- 説明（何をするか）
- 入力/出力（必要資料、生成物）
- 担当ロール/カテゴリ
- 参考リンク（ファイル共有・申請ページ・手順書など）

### 4) 検索 / フィルタ
- ノード名・説明・タグ等を対象にクライアントサイド検索
- カテゴリ/担当/ステータスなどでフィルタ

### 5) お気に入り
- ノードをお気に入り登録（Local Storage）
- お気に入り絞り込み表示

### 6) タブ
- 例：`フロー` / `一覧` / `About`

---

## システム構築の課題（現状の痛点）
### 課題A：ノードが意図した位置に配置されない
- 自動レイアウトだけに依存すると「意図した配置」にならない可能性が高い

### 課題B：ノード間の線が意図した接続がされない
- 推測接続はNG。接続は必ずデータで明示する必要がある

### 課題C：数が多く、配置方法が難しい
- スケール時に視認性/操作性が崩れるリスクが高い

---

## 対処方針（Implementation Policy）
### 1) 位置は「手動座標優先」
- `public/data.json` のノードに `position: {x,y}` を持たせる
- `position` が無い場合のみ自動レイアウトで補完（任意）

### 2) 接続は「edgesで明示」
- `edges: [{source,target,label,condition}]` を必ず用意
- UI側が推測で線を引かない

### 3) 大規模化対策
- グルーピング（フェーズ/工程）を `groups` として定義（任意だが推奨）
- 一覧（検索特化）→フロー上の該当ノードへフォーカス（ズーム移動）できる設計が望ましい

---

## データ仕様（public/data.json：唯一の正）
最低限の想定スキーマ（例）：

```json
{
  "meta": {
    "title": "工事システムフロー",
    "version": "1.0.0",
    "updatedAt": "2026-02-16",
    "defaultLayout": "manual"
  },
  "nodes": [
    {
      "id": "N-001",
      "title": "申請書作成",
      "description": "申請に必要な書類を作成する。誤記があると差し戻しになるためチェック必須。",
      "role": "申請",
      "category": "書類",
      "status": "active",
      "tags": ["申請", "書類"],
      "position": { "x": 120, "y": 200 },
      "links": [
        { "label": "共有フォルダ", "url": "https://example.com/share/xxxx" }
      ],
      "inputs": ["工事概要", "図面"],
      "outputs": ["申請書PDF"],
      "next": ["N-002", "N-010"]
    }
  ],
  "edges": [
    {
      "id": "E-001",
      "source": "N-001",
      "target": "N-002",
      "label": "通常ルート",
      "condition": "書類が揃っている"
    }
  ],
  "groups": [
    {
      "id": "G-01",
      "title": "申請フェーズ",
      "nodeIds": ["N-001", "N-002"]
    }
  ]
}
